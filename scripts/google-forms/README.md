# Google Forms Session Feedback Generator

This module automatically creates Google Forms for each session in your SQL Saturday event using the Sessionize API data.

## Files

### Main Scripts
- **`Generate-SessionFeedbackForms.ps1`** - Main script that creates Google Forms for each session
- **`Download-SessionData.ps1`** - Downloads session data from Sessionize API
- **`Setup-GoogleFormsAPI.ps1`** - Instructions for setting up Google Forms API credentials
- **`Test-OAuth-Manual.ps1`** - Simple test script to verify OAuth authentication

### Configuration
- **`config/google-credentials.json`** - OAuth 2.0 credentials from Google Cloud Console
- **`config/google-credentials-sample.json`** - Template for credentials file

### Data Files
- **`sessions.json`** - Downloaded session data from Sessionize (generated by Download-SessionData.ps1)

## Features

- **Automated Form Creation**: Creates a feedback form for each session
- **Standardized Questions**: Consistent rating questions (1-5 scale) and open-ended feedback
- **Secure Authentication**: OAuth 2.0 implementation with token caching
- **Session Integration**: Pulls session data directly from Sessionize API
- **Bulk Processing**: Handles all sessions across multiple rooms/tracks

## Prerequisites

1. **Google Cloud Project**
   - Create a project at [Google Cloud Console](https://console.cloud.google.com/)
   - Enable the Google Forms API
   - Set up OAuth 2.0 credentials (Desktop Application type)

2. **PowerShell 7+**
   - Required for proper REST API support
   - Cross-platform compatibility

3. **Internet Access**
   - For API calls to Google and Sessionize

## Quick Start

1. **Setup Google API Access**
   ```powershell
   .\Setup-GoogleFormsAPI.ps1
   ```

2. **Configure Credentials**
   - Follow the setup instructions
   - Download OAuth 2.0 credentials from Google Cloud Console
   - Save as `config\google-credentials.json`

3. **Test Authentication**
   ```powershell
   .\Test-OAuth-Manual.ps1
   ```

4. **Generate Forms**
   ```powershell
   $credentials = Get-Content .\config\google-credentials.json | ConvertFrom-Json
   $clientId = $credentials.installed.client_id
   $clientSecret = ConvertTo-SecureString $credentials.installed.client_secret -AsPlainText -Force
   .\Generate-SessionFeedbackForms.ps1 -ClientId $clientId -ClientSecret $clientSecret
   ```

## Manual Usage

For more control, you can run the main script directly:

```powershell
# Load your credentials
$credentials = Get-Content "config\google-credentials.json" | ConvertFrom-Json
$clientId = $credentials.installed.client_id
$clientSecret = Read-Host "Enter Client Secret" -AsSecureString

# Generate forms
.\Generate-SessionFeedbackForms.ps1 -ClientId $clientId -ClientSecret $clientSecret
```

## Form Structure

Each generated form includes:

### Rating Questions (1-5 Scale)
1. **Speaker Knowledge** - Subject matter expertise
2. **Presentation Skills** - Delivery and communication
3. **Demos and Examples** - Quality and relevance of demonstrations
4. **Learning Expectations** - Whether the session met expectations

### Open-Ended Questions
5. **Improvement Suggestions** - Constructive feedback for speakers
6. **Positive Feedback** - What attendees enjoyed most

## Security Features

- **Secure Authentication**: Uses OAuth 2.0 with refresh tokens
- **Token Caching**: Automatically handles token refresh
- **Credential Protection**: Client secrets handled as SecureString
- **Minimal Permissions**: Only requests necessary Google Forms access

## Output

The script generates:

- **CSV Report**: `output/session-forms.csv` with all form URLs
- **Summary Report**: `output/session-forms-summary.txt` with statistics
- **Individual Forms**: One Google Form per session

### CSV Columns
- SessionId
- SessionTitle
- Speakers
- Room
- StartTime
- FormId
- FormUrl (for attendees)
- ResponsesUrl (for organizers)

## File Structure

```
scripts/google-forms/
├── Generate-SessionFeedbackForms.ps1  # Main script
├── GoogleFormsAuth.psm1               # Authentication module
├── Setup-GoogleFormsAPI.ps1           # Setup helper
├── Run-Example.ps1                    # Quick start example
└── README.md                          # This file

config/
└── google-credentials.json            # Your OAuth 2.0 credentials

output/
├── session-forms.csv                  # Generated forms list
└── session-forms-summary.txt          # Summary report
```

## Error Handling

The script includes comprehensive error handling:

- **Authentication Failures**: Clear instructions for credential issues
- **API Rate Limits**: Automatic delays between requests
- **Network Issues**: Retry logic for transient failures
- **Form Creation Errors**: Continues processing other sessions

## Customization

### Modify Questions
Edit the `New-SessionFeedbackForm` function to change:
- Question text and descriptions
- Rating scales (currently 1-5)
- Required vs optional questions
- Form title and description

### Add Question Types
The Google Forms API supports:
- Multiple choice
- Checkboxes
- Dropdown
- Linear scale (rating)
- Text (short and paragraph)
- Date/time

### Filter Sessions
Modify the session filtering logic to:
- Skip certain session types
- Include/exclude specific tracks
- Handle workshops differently

## Troubleshooting

### Common Issues

1. **"Forms API not enabled"**
   - Go to Google Cloud Console → APIs & Services → Library
   - Search for "Google Forms API" and enable it

2. **"OAuth consent screen not configured"**
   - Configure OAuth consent screen in Google Cloud Console
   - Add test users during development

3. **"Invalid client credentials"**
   - Verify client_id and client_secret in credentials file
   - Ensure you downloaded the correct JSON file

4. **"Access token expired"**
   - Delete cached tokens: `Remove-Item $env:TEMP\google-forms-tokens.json`
   - Re-run authentication flow

### Debug Mode

Enable verbose logging:
```powershell
$VerbosePreference = "Continue"
.\Generate-SessionFeedbackForms.ps1 -Verbose
```

## API Limits

Google Forms API limits:
- **Forms**: 200 forms per user per day
- **Requests**: 100 requests per 100 seconds per user
- **Batch operations**: 100 operations per request

The script includes rate limiting to stay within these bounds.

## Best Practices

1. **Test First**: Run with a subset of sessions initially
2. **Backup Forms**: Export form URLs before the event
3. **Monitor Responses**: Check response collection during the event
4. **Share Responsibly**: Distribute form URLs through official channels only

## Integration Ideas

- **QR Codes**: Generate QR codes for each form URL
- **Email Integration**: Send form links to attendees post-session
- **Mobile App**: Integrate form URLs into event mobile apps
- **Session Materials**: Include feedback links in slide templates

## Support

For issues with this script:
1. Check the troubleshooting section
2. Review Google Forms API documentation
3. Verify Google Cloud project setup
4. Test with a simple form creation manually

## License

This script is part of the SQL Saturday event management system.
Use and modify as needed for your events.
